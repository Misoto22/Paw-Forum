{% block content %}
<div class="forum-container">
  <!-- Forum header -->
  <div class="forum-header">
    <!-- Header content -->
  </div>

  <!-- User list container inside forum detail -->
  <div class="user-list-container">
    <div class="user-list">
      <button id="action-button" class="action-button">Apply</button>
      <!-- Add the action button here -->

      <div
        class="user"
        data-username="john_doe"
        data-name="John Doe"
        data-gender="Male"
        data-postcode="12345"
        data-email="john@example.com"
        data-phone="123-456-7890"
        data-pettype="Dog"
      >
        <img
          src="{{ url_for('static', filename='image/avatars/avatar1.png') }}"
          alt="User Avatar"
          class="user-avatar"
        />
        <span class="user-username">john_doe</span>
      </div>

      <div
        class="user"
        data-username="jane_smith"
        data-name="Jane Smith"
        data-gender="Female"
        data-postcode="67890"
        data-email="jane@example.com"
        data-phone="987-654-3210"
        data-pettype="Cat"
      >
        <img
          src="{{ url_for('static', filename='image/avatars/avatar21.png') }}"
          alt="User Avatar"
          class="user-avatar"
        />
        <span class="user-username">jane_smith</span>
      </div>

      <div
        class="user"
        data-username="mike_jones"
        data-name="Mike Jones"
        data-gender="Male"
        data-postcode="11223"
        data-email="mike@example.com"
        data-phone="555-666-7777"
        data-pettype="Bird"
      >
        <img
          src="{{ url_for('static', filename='image/avatars/avatar3.png') }}"
          alt="User Avatar"
          class="user-avatar"
        />
        <span class="user-username">mike_jones</span>
      </div>

      <div
        class="user"
        data-username="sarah_lee"
        data-name="Sarah Lee"
        data-gender="Female"
        data-postcode="44556"
        data-email="sarah@example.com"
        data-phone="444-555-6666"
        data-pettype="Fish"
      >
        <img
          src="{{ url_for('static', filename='image/avatars/avatar24.png') }}"
          alt="User Avatar"
          class="user-avatar"
        />
        <span class="user-username">sarah_lee</span>
      </div>

      <div
        class="user"
        data-username="david_wang"
        data-name="David Wang"
        data-gender="Male"
        data-postcode="77889"
        data-email="david@example.com"
        data-phone="333-222-1111"
        data-pettype="Rabbit"
      >
        <img
          src="{{ url_for('static', filename='image/avatars/avatar5.png') }}"
          alt="User Avatar"
          class="user-avatar"
        />
        <span class="user-username">david_wang</span>
      </div>
      <!-- Add more users as needed -->
    </div>
  </div>

  <!-- User info popup -->
  <div id="user-info-popup" class="user-info-popup">
    <div class="popup-content">
      <span class="close-popup">&times;</span>
      <p><strong>Name:</strong> <span id="popup-name"></span></p>
      <p><strong>Gender:</strong> <span id="popup-gender"></span></p>
      <p><strong>Post Code:</strong> <span id="popup-postcode"></span></p>
      <p><strong>Email:</strong> <span id="popup-email"></span></p>
      <p><strong>Phone:</strong> <span id="popup-phone"></span></p>
      <p><strong>Pet Type:</strong> <span id="popup-pettype"></span></p>
    </div>
  </div>

   <!-- Reply Section-->
  <div class="reply-section">
    <div class="reply-form">
      <p>Add a comment</p>
      <textarea placeholder="Write your reply here "></textarea>
      <button id="submitReplyBtn">Submit</button>
    </div>

    <div class="replies">
      {% for reply in post.replies %}
      <div class="reply">
        <div class="reply-header">
          <img src="{{ reply.author.user_image }}" alt="User Avatar" class="reply-avatar" />
          <span class="reply-username">{{ reply.author.username }}</span>
          <span class="reply-time">{{ reply.post_at.strftime('%Y-%m-%d %H:%M') }}</span>
        </div>
        <div class="reply-content">{{ reply.content }}</div>
        <div class="reply-footer">
          <button class="reply-button">Reply</button>
          
          <!-- Add delete icon for reply -->
          <span class="delete">
            <img
              src="{{ url_for('static', filename='image/bin.png') }}"
              alt="Delete"
              class="delete-icon delete-reply"
            />
          </span>
        </div>
        <div class="nested-reply-form">
          <textarea placeholder="Write your reply..."></textarea>
          <button class="submit-nested-reply">Reply</button>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<!-- Delete confirmation modal -->
<div id="deleteModal" class="modal">
  <div class="modal-content">
    <span class="close-btn">&times;</span>
    <p>Are you sure you want to delete this post/comment?</p>
    <button id="confirmDelete" class="btn-confirm">Yes</button>
    <button id="cancelDelete" class="btn-cancel">No</button>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Example of handling the apply button
    const actionButton = document.getElementById("action-button");
    actionButton.addEventListener("click", function () {
      actionButton.disabled = true;
      actionButton.style.backgroundColor = "grey";
      actionButton.innerText = "Applied";
      // Here you can add the logic for applying or closing the task
    });
  });
  document.addEventListener("DOMContentLoaded", function () {
    // Get modal elements
    var modal = document.getElementById("deleteModal");
    var closeBtn = document.getElementsByClassName("close-btn")[0];
    var confirmDelete = document.getElementById("confirmDelete");
    var cancelDelete = document.getElementById("cancelDelete");
    var deleteTarget; // To store the element to be deleted

    // Show modal on delete icon click
    document.querySelectorAll(".delete-icon").forEach(function (deleteIcon) {
      deleteIcon.onclick = function () {
        modal.style.display = "block";
        deleteTarget = this; // Store the delete icon that was clicked
      };
    });

    // Hide modal on close button click
    closeBtn.onclick = function () {
      modal.style.display = "none";
    };

    // Hide modal on cancel button click
    cancelDelete.onclick = function () {
      modal.style.display = "none";
    };

    // Handle confirm delete button click
    confirmDelete.onclick = function () {
      // Placeholder for AJAX request to delete post/comment
      alert("Deleted successfully."); // Replace with actual AJAX request
      modal.style.display = "none";

      // Remove the target element from DOM
      if (deleteTarget) {
        deleteTarget.closest(".reply, .forum-detail").remove();
      }
    };

    // Hide modal when clicking outside the modal content
    window.onclick = function (event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    };
  });
</script>
<script src="{{ url_for('static', filename='js/topic_reply.js') }}"></script>
<script src="{{ url_for('static', filename='js/user_info_popup.js') }}"></script>
{% endblock %}
